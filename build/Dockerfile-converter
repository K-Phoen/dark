# Build
FROM golang:1.17-alpine3.14 AS build

RUN apk --update --no-cache add make=4.3-r0

WORKDIR /app
COPY . /app

RUN make converter_build

# Run

FROM alpine:3.14
ENTRYPOINT ["/app/dark-converter"]
WORKDIR /workspace
RUN apk --update --no-cache add ca-certificates=20191127-r5 && update-ca-certificates

COPY --from=build /app/dark-converter /app/dark-converter
